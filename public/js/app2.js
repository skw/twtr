// Generated by CoffeeScript 1.6.2
(function() {
  var ResultsView, Router, Tweet, TweetView, Tweets, appRouter;

  Tweet = Backbone.Model.extend();

  Tweets = Backbone.Collection.extend({
    model: Tweet
  });

  ResultsView = Backbone.View.extend({
    el: $('#search'),
    events: {
      'click button#s': 'searchHash',
      'keypress :input': 'keyPressed'
    },
    keyPressed: function(e) {
      if (e.keyCode === 13) {
        return this.searchHash(e);
      }
    },
    searchHash: function(e) {
      var hash, q, _this;

      e.preventDefault();
      console.clear();
      $('#results').fadeOut();
      $('#results').empty();
      q = $('#q').val();
      hash = '%23';
      console.log('searching: ' + q);
      _this = this;
      return $.getJSON('http://search.twitter.com/search.json?callback=?', {
        q: hash + q
      }, function(data) {
        var i, tweet, tweetView;

        for (i in data.results) {
          console.log(i);
          tweet = new Tweet(data.results[i]);
          console.log(data.results[i]);
          tweetView = new TweetView({
            model: tweet
          });
          tweetView.render();
        }
        return $('#results').fadeIn();
      });
    }
  });

  TweetView = Backbone.View.extend({
    render: function() {
      var result_template, tweet;

      result_template = '\
		<tr>\
			<td> <%= id %> </td>\
			<td> <a href="http://twitter.com/<%= from_user %>" title="<%= from_user %>">@<%= from_user %></a> </td>\
			<td> <%= text %> </td>\
		</tr>';
      tweet = _.template(result_template, this.model.toJSON());
      return $('#results').append(tweet);
    }
  });

  Router = Backbone.Router.extend({
    routes: {
      "": "index"
    },
    index: function() {
      var resultsView;

      return resultsView = new ResultsView;
    }
  });

  appRouter = new Router();

  Backbone.history.start();

}).call(this);
